version: "3"

# ============================================================================
# VARIABLES
# ============================================================================
vars:
  BINARY_NAME: dev-stack
  BUILD_DIR: build
  MODULE_PATH: github.com/isaacgarza/dev-stack
  VERSION:
    sh: git describe --tags --always --dirty 2>/dev/null || echo "dev"
  COMMIT:
    sh: git rev-parse --short HEAD 2>/dev/null || echo "unknown"
  BUILD_DATE:
    sh: date -u +"%Y-%m-%dT%H:%M:%SZ"
  LDFLAGS: '-ldflags "-X {{.MODULE_PATH}}/internal/cli.version={{.VERSION}} -X {{.MODULE_PATH}}/internal/cli.commit={{.COMMIT}} -X {{.MODULE_PATH}}/internal/cli.date={{.BUILD_DATE}}"'
  GOLANGCI_LINT_VERSION: "v2.4.0"

# ============================================================================
# TASKS
# ============================================================================
tasks:
  # ----------------------------------------------------------------------------
  # DEFAULT TASK
  # ----------------------------------------------------------------------------
  default:
    desc: "ğŸš€ Build the binary (default task)"
    silent: true
    cmds:
      - task: build

  # ----------------------------------------------------------------------------
  # BUILD TASKS
  # ----------------------------------------------------------------------------
  build:
    desc: "ğŸ”¨ Build the Go binary for current platform"
    deps: [deps]
    sources:
      - "**/*.go"
      - "go.mod"
      - "go.sum"
    generates:
      - "{{.BUILD_DIR}}/{{.BINARY_NAME}}"
    silent: true
    cmds:
      - echo "ğŸ”¨ Building {{.BINARY_NAME}}..."
      - mkdir -p {{.BUILD_DIR}}
      - go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}} ./cmd/dev-stack
      - echo "âœ… Built at {{.BUILD_DIR}}/{{.BINARY_NAME}}"

  build-all:
    desc: "ğŸŒ Build binaries for all supported platforms"
    deps: [deps]
    silent: true
    cmds:
      - echo "ğŸŒ Building {{.BINARY_NAME}} for all platforms..."
      - mkdir -p {{.BUILD_DIR}}
      - GOOS=linux GOARCH=amd64 go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}}-linux-amd64 ./cmd/dev-stack
      - GOOS=linux GOARCH=arm64 go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}}-linux-arm64 ./cmd/dev-stack
      - GOOS=darwin GOARCH=amd64 go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}}-darwin-amd64 ./cmd/dev-stack
      - GOOS=darwin GOARCH=arm64 go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}}-darwin-arm64 ./cmd/dev-stack
      - GOOS=windows GOARCH=amd64 go build {{.LDFLAGS}} -o {{.BUILD_DIR}}/{{.BINARY_NAME}}-windows-amd64.exe ./cmd/dev-stack
      - echo "âœ… All binaries built in {{.BUILD_DIR}}/"

  install:
    desc: "ğŸ“¦ Install the binary to GOPATH/bin"
    deps: [build]
    silent: true
    cmds:
      - echo "ğŸ“¦ Installing {{.BINARY_NAME}}..."
      - go install {{.LDFLAGS}} ./cmd/dev-stack
      - echo "âœ… Installed to $(go env GOPATH)/bin/{{.BINARY_NAME}}"

  # ----------------------------------------------------------------------------
  # DEVELOPMENT TASKS
  # ----------------------------------------------------------------------------
  dev:
    desc: "ğŸš€ Quick start - build and show help"
    deps: [build]
    silent: true
    cmds:
      - echo "ğŸš€ Running {{.BINARY_NAME}} in development mode..."
      - ./{{.BUILD_DIR}}/{{.BINARY_NAME}} --help

  watch:
    desc: "ğŸ‘€ Watch for changes and rebuild automatically"
    watch: true
    sources:
      - "**/*.go"
    silent: true
    cmds:
      - echo "ğŸ‘€ Rebuilding due to changes..."
      - task: build

  # ----------------------------------------------------------------------------
  # TEST MANAGEMENT
  # ----------------------------------------------------------------------------
  test-cleanup-verify:
    desc: "ğŸ“Š Verify test cleanup and organization"
    cmds:
      - |
        echo "ğŸ“Š Test file analysis:"
        find . -name "*_test.go" -type f | wc -l | xargs echo "Total test files:"
        find . -name "*_test.go" -exec wc -l {} + | tail -1 | xargs echo "Total test lines:"
        echo ""
        echo "ğŸ” Init package test files:"
        find ./internal/pkg/cli/handlers/init -name "*_test.go" -exec basename {} \; | sort
        echo ""
        echo "ğŸ“ˆ Init package test coverage:"
        go test -cover ./internal/pkg/cli/handlers/init/...

  # ----------------------------------------------------------------------------
  # DEPENDENCY MANAGEMENT
  # ----------------------------------------------------------------------------
  deps:
    desc: "ğŸ“¥ Download and tidy Go dependencies"
    silent: true
    cmds:
      - echo "ğŸ“¥ Downloading Go dependencies..."
      - go mod download
      - go mod tidy
      - echo "âœ… Dependencies updated"

  # ----------------------------------------------------------------------------
  # GIT AUTOMATION
  # ----------------------------------------------------------------------------
  commit:
    desc: "ğŸ“ Generate and create commit with dynamic message based on staged changes"
    silent: true
    cmds:
      - |
        # Check if there are staged changes
        STAGED_FILES=$(git diff --cached --name-only)
        if [ -z "$STAGED_FILES" ]; then
          echo "âŒ No staged changes found. Use 'git add' first."
          exit 1
        fi

        echo "ğŸ“ Analyzing staged changes..."

        # Generate commit type and scope
        TYPE="feat"
        SCOPE=""
        DESCRIPTION=""

        # Analyze file types
        if echo "$STAGED_FILES" | grep -q "_test\.go"; then
          TYPE="test"
          TEST_COUNT=$(echo "$STAGED_FILES" | grep "_test\.go" | wc -l | tr -d ' ')
          DESCRIPTION="add $TEST_COUNT test files"
        fi

        if echo "$STAGED_FILES" | grep -q "\.go" | grep -v "_test\.go"; then
          if [ "$TYPE" = "test" ]; then
            TYPE="feat"
            DESCRIPTION="add tests and update code"
          else
            TYPE="feat"
            SRC_COUNT=$(echo "$STAGED_FILES" | grep "\.go" | grep -v "_test\.go" | wc -l | tr -d ' ')
            DESCRIPTION="update $SRC_COUNT source files"
          fi
        fi

        if echo "$STAGED_FILES" | grep -q "\.yml\|\.yaml"; then
          if echo "$STAGED_FILES" | grep -q "\.golangci\.yml"; then
            TYPE="config"
            SCOPE="lint"
            DESCRIPTION="update linting configuration"
          elif echo "$STAGED_FILES" | grep -q "Taskfile\.yml"; then
            TYPE="build"
            SCOPE="tasks"
            DESCRIPTION="update build automation"
          elif echo "$STAGED_FILES" | grep -q "ci\.yml\|\.github"; then
            TYPE="ci"
            DESCRIPTION="update CI/CD configuration"
          else
            TYPE="config"
            DESCRIPTION="update configuration files"
          fi
        fi

        if echo "$STAGED_FILES" | grep -q "README\|\.md"; then
          TYPE="docs"
          DESCRIPTION="update documentation"
        fi

        if echo "$STAGED_FILES" | grep -q "package\.json\|go\.mod\|go\.sum"; then
          TYPE="deps"
          DESCRIPTION="update dependencies"
        fi

        # Check for specific patterns in file names
        if echo "$STAGED_FILES" | grep -qi "fix\|bug"; then
          TYPE="fix"
        fi

        # Build commit message
        if [ -n "$SCOPE" ]; then
          COMMIT_MSG="$TYPE($SCOPE): $DESCRIPTION"
        else
          COMMIT_MSG="$TYPE: $DESCRIPTION"
        fi

        # Show what will be committed
        echo "ğŸ” Staged files:"
        echo "$STAGED_FILES" | sed 's/^/  /'
        echo ""
        echo "ğŸ“ Generated commit message:"
        echo "  $COMMIT_MSG"
        echo ""

        # Commit with generated message
        git commit -m "$COMMIT_MSG"
        echo "âœ… Committed successfully!"

  # === GIT AUTOMATION ===
  create-pr:
    desc: "ğŸ”€ Create a pull request with auto-generated title and description based on branch changes"
    silent: true
    cmds:
      - |
        BRANCH=$(git branch --show-current)
        if [ "$BRANCH" = "main" ]; then
          echo "âŒ Cannot create PR from main branch"
          exit 1
        fi

        echo "ğŸ”€ Analyzing changes in branch: $BRANCH"

        # Get commit messages and changed files
        COMMITS=$(git log --oneline main..$BRANCH)
        COMMIT_COUNT=$(git rev-list --count main..$BRANCH)
        CHANGED_FILES=$(git diff --name-only main..$BRANCH)

        # Analyze changes to generate title
        TITLE="feat: "
        if echo "$CHANGED_FILES" | grep -q "_test\.go"; then
          TITLE="${TITLE}Add tests and "
        fi
        if echo "$CHANGED_FILES" | grep -q "\.yml\|\.yaml"; then
          TITLE="${TITLE}improve CI/CD and "
        fi
        if echo "$CHANGED_FILES" | grep -q "Taskfile\.yml"; then
          TITLE="${TITLE}enhance build automation and "
        fi
        if echo "$COMMITS" | grep -qi "fix\|bug"; then
          TITLE="${TITLE}fix issues and "
        fi
        TITLE="${TITLE}improve codebase"

        # Generate description based on file changes
        DESCRIPTION="## ğŸš€ Changes Summary

        **Branch:** \`$BRANCH\`
        **Commits:** $COMMIT_COUNT

        ### ğŸ“ Recent Commits
        \`\`\`
        $COMMITS
        \`\`\`

        ### ğŸ“ Files Changed"

        if echo "$CHANGED_FILES" | grep -q "_test\.go"; then
          TEST_COUNT=$(echo "$CHANGED_FILES" | grep "_test\.go" | wc -l)
          DESCRIPTION="$DESCRIPTION
        - **ğŸ§ª Tests:** $TEST_COUNT test files added/modified"
        fi

        if echo "$CHANGED_FILES" | grep -q "\.go" | grep -v "_test\.go"; then
          SRC_COUNT=$(echo "$CHANGED_FILES" | grep "\.go" | grep -v "_test\.go" | wc -l)
          DESCRIPTION="$DESCRIPTION
        - **ğŸ“¦ Source Code:** $SRC_COUNT Go files modified"
        fi

        if echo "$CHANGED_FILES" | grep -q "\.yml\|\.yaml"; then
          CONFIG_COUNT=$(echo "$CHANGED_FILES" | grep "\.yml\|\.yaml" | wc -l)
          DESCRIPTION="$DESCRIPTION
        - **âš™ï¸ Configuration:** $CONFIG_COUNT YAML files updated"
        fi

        if echo "$CHANGED_FILES" | grep -q "Taskfile\.yml"; then
          DESCRIPTION="$DESCRIPTION
        - **ğŸ”§ Build System:** Taskfile.yml updated"
        fi

        DESCRIPTION="$DESCRIPTION

        ### ğŸ” Changed Files
        \`\`\`
        $CHANGED_FILES
        \`\`\`

        ## ğŸ§ª Testing
        - [ ] All tests pass
        - [ ] No breaking changes
        - [ ] Documentation updated if needed"

        # Create PR
        gh pr create \
          --title "$TITLE" \
          --body "$DESCRIPTION" \
          --assignee @me

  push-and-pr:
    desc: "ğŸš€ Push current branch and create PR in one command"
    silent: true
    cmds:
      - |
        BRANCH=$(git branch --show-current)
        echo "ğŸš€ Pushing branch: $BRANCH"
        git push -u origin $BRANCH
      - task: create-pr

  pre-commit:
    desc: "ğŸ”’ Run all pre-commit checks"
    silent: true
    cmds:
      - echo "ğŸ”’ Running pre-commit checks..."
      - task: pre-commit-fix
      - task: pre-commit-verify

  pre-commit-fix:
    desc: "ğŸ”§ Auto-fix formatting and module issues"
    silent: true
    cmds:
      - echo "ğŸ”§ Auto-fixing formatting and modules..."
      - task: fmt
      - go mod tidy

  pre-commit-verify:
    desc: "âœ… Verify all checks pass after fixes"
    silent: true
    cmds:
      - |
        echo "âœ… Verifying fixes..."
        UNSTAGED_CHANGES=$(git diff --name-only)
        if [ -n "$UNSTAGED_CHANGES" ]; then
          echo ""
          echo "âŒ Pre-commit failed: Files were modified during formatting/tidy"
          echo ""
          echo "ğŸ“‹ Modified files:"
          git diff --name-only
          echo ""
          echo "ğŸ”§ Please add these changes and commit again:"
          echo "   git add ."
          echo "   git commit"
          echo ""
          exit 1
        fi
      - task: lint
      - echo "âœ… Pre-commit checks passed"

  pre-push:
    desc: "ğŸš€ Run all pre-push checks"
    silent: true
    cmds:
      - echo "ğŸš€ Running pre-push checks..."
      - task: test
      - task: test-coverage-check
      - task: build
      - task: docs-lastmod-update
      - echo "âœ… Pre-push checks passed"

  fmt-check:
    desc: "ğŸ“ Check Go code formatting"
    silent: true
    cmds:
      - |
        if [ "$(gofmt -s -l . | wc -l)" -gt 0 ]; then
          echo "âŒ Code is not formatted. Run: task fmt"
          gofmt -s -l .
          exit 1
        fi
        echo "âœ… Code formatting OK"

  mod-tidy-check:
    desc: "ğŸ“¦ Check if go.mod is tidy"
    silent: true
    cmds:
      - go mod tidy
      - |
        if ! git diff --exit-code go.mod go.sum; then
          echo "âŒ go.mod/go.sum not tidy. Run: go mod tidy"
          exit 1
        fi
        echo "âœ… Go modules are tidy"

  lint-md:
    desc: "ğŸ“ Lint markdown files"
    silent: true
    cmds:
      - echo "ğŸ“ Linting markdown files..."
      - cd docs-site && npm run lint:md
      - echo "âœ… Markdown linting passed"

  docs-sync-check:
    desc: "ğŸ“š Check if documentation is in sync"
    silent: true
    cmds:
      - cd docs-site && npm run docs:generate
      - |
        # Check if there are content changes (ignoring timestamp changes in frontmatter)
        DIFF_OUTPUT=$(git diff docs-site/content/_index.md docs-site/content/reference.md docs-site/content/services.md | grep -v "^[+-]date:" | grep -v "^[+-]lastmod:")
        if echo "$DIFF_OUTPUT" | grep -q "^[+-]"; then
          echo "âŒ Documentation content out of sync. Run: cd docs-site && npm run docs:generate"
          echo "$DIFF_OUTPUT"
          exit 1
        fi
        echo "âœ… Documentation is in sync"

  docs-lastmod-update:
    desc: "ğŸ—“ï¸ Update lastmod dates for changed documentation files"
    silent: true
    cmds:
      - ./scripts/update-docs-lastmod.sh

  setup-hooks:
    desc: "ğŸª Install Git hooks for pre-commit and pre-push checks"
    silent: true
    cmds:
      - ./scripts/setup-hooks.sh

  refactor-tests:
    desc: "ğŸ”§ Refactor test files to use constants instead of magic strings"
    silent: true
    cmds:
      - |
        echo "ğŸ”§ Refactoring test magic strings..."
        echo "âœ… Test constants file created at internal/pkg/cli/handlers/init/test_constants.go"
        echo "ğŸ“ Manual refactoring recommended for context-specific strings"
        echo ""
        echo "Common patterns to replace:"
        echo "  - \"dev-stack-test-*\" â†’ TestTempDirPattern"
        echo "  - \"dev-stack\" â†’ constants.DevStackDir"
        echo "  - \"dev-stack-config.yml\" â†’ constants.ConfigFileName"
        echo "  - \"test\" â†’ TestConfigContent (when used as file content)"
        echo "  - \"postgres\" â†’ TestServicePostgres"
        echo "  - \"already initialized\" â†’ MsgAlreadyInitialized"

  # ----------------------------------------------------------------------------
  # TESTING & QUALITY ASSURANCE
  # ----------------------------------------------------------------------------
  test:
    desc: "ğŸ§ª Run all tests with coverage report"
    deps: [deps]
    sources:
      - "**/*.go"
      - "go.mod"
      - "go.sum"
    generates:
      - "coverage.out"
    silent: true
    cmds:
      - echo "ğŸ§ª Running tests with coverage..."
      - go test -v -race -coverprofile=coverage.out -covermode=atomic ./...
      - echo "âœ… Coverage report at coverage.out"

  test-coverage:
    desc: "ğŸ“Š View test coverage report in browser"
    deps: [test]
    silent: true
    cmds:
      - echo "ğŸ“Š Opening coverage report..."
      - go tool cover -html=coverage.out

  test-coverage-check:
    desc: "ğŸ¯ Check if test coverage meets minimum threshold"
    deps: [test]
    silent: true
    cmds:
      - |
        COVERAGE=$(go tool cover -func=coverage.out | grep total | awk '{print $3}' | sed 's/%//')
        MIN_COVERAGE=15.0
        echo "Current test coverage: ${COVERAGE}%"
        echo "Minimum threshold: ${MIN_COVERAGE}%"

        if command -v bc >/dev/null 2>&1; then
          if (( $(echo "$COVERAGE < $MIN_COVERAGE" | bc -l) )); then
            echo "âŒ Test coverage ${COVERAGE}% is below minimum threshold ${MIN_COVERAGE}%"
            exit 1
          else
            echo "âœ… Test coverage ${COVERAGE}% meets minimum threshold ${MIN_COVERAGE}%"
          fi
        else
          # Fallback for systems without bc
          COVERAGE_INT=$(echo "$COVERAGE" | cut -d'.' -f1)
          MIN_COVERAGE_INT=$(echo "$MIN_COVERAGE" | cut -d'.' -f1)
          if [ "$COVERAGE_INT" -lt "$MIN_COVERAGE_INT" ]; then
            echo "âŒ Test coverage ${COVERAGE}% is below minimum threshold ${MIN_COVERAGE}%"
            exit 1
          else
            echo "âœ… Test coverage ${COVERAGE}% meets minimum threshold ${MIN_COVERAGE}%"
          fi
        fi

  test-unit:
    desc: "ğŸ§ª Run unit tests only"
    deps: [deps]
    silent: true
    cmds:
      - echo "ğŸ§ª Running unit tests..."
      - go test -race -short ./...
      - echo "âœ… Unit tests passed"

  test-integration:
    desc: "ğŸ”— Run integration tests"
    deps: [deps]
    silent: true
    cmds:
      - echo "ğŸ”— Running integration tests..."
      - go test -race -tags=integration ./...
      - echo "âœ… Integration tests passed"

  test-all:
    desc: "ğŸ§ª Run all test types"
    deps: [test-unit, test-integration]
    silent: true
    cmds:
      - echo "âœ… All tests completed successfully"

  lint:
    desc: "ğŸ” Run comprehensive linting (vet + fmt + golangci-lint)"
    deps: [deps]
    silent: true
    cmds:
      - echo "ğŸ” Running go vet..."
      - go vet ./...
      - echo "ğŸ” Checking code formatting..."
      - |
        if [ "$(gofmt -l . | wc -l)" -gt 0 ]; then
          echo "âŒ Code is not formatted. Run 'task fmt' to fix:"
          gofmt -l .
          exit 1
        fi
      - echo "âœ… Basic linting passed"
      - echo "ğŸ” Running golangci-lint config verify..."
      - |
        if [ ! -f .golangci.yml ]; then
          echo "âŒ .golangci.yml config file not found!"
          exit 1
        fi
        if [ ! -f $(go env GOPATH)/bin/golangci-lint ]; then
          echo "ğŸ“¦ Installing golangci-lint {{.GOLANGCI_LINT_VERSION}}..."
          curl -sSfL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh | sh -s -- -b $(go env GOPATH)/bin {{.GOLANGCI_LINT_VERSION}}
        fi
        $(go env GOPATH)/bin/golangci-lint config verify
      - echo "âœ… golangci-lint config is valid"
      - echo "ğŸ” Running golangci-lint..."
      - $(go env GOPATH)/bin/golangci-lint run ./...
      - echo "âœ… All linting checks passed!"

  fmt:
    desc: "âœ¨ Format Go code with gofmt and goimports"
    silent: true
    cmds:
      - echo "âœ¨ Formatting Go code..."
      - |
        if [ ! -f $(go env GOPATH)/bin/goimports ]; then
          echo "ğŸ“¦ Installing goimports..."
          go install golang.org/x/tools/cmd/goimports@latest
        fi
      - go fmt ./...
      - $(go env GOPATH)/bin/goimports -w .
      - echo "âœ… Code formatted"

  security:
    desc: "ğŸ”’ Run security vulnerability scan"
    deps: [deps]
    silent: true
    cmds:
      - echo "ğŸ”’ Running security scan..."
      - |
        if ! command -v govulncheck >/dev/null 2>&1; then
          echo "ğŸ“¦ Installing govulncheck..."
          go install golang.org/x/vuln/cmd/govulncheck@latest
        fi
      - govulncheck ./...
      - echo "âœ… Security scan complete"

  # ----------------------------------------------------------------------------
  # DOCUMENTATION
  # ----------------------------------------------------------------------------
  docs:
    desc: "ğŸ“š Generate documentation"
    deps: [build]
    silent: true
    cmds:
      - echo "ğŸ“š Generating documentation..."
      - ./{{.BUILD_DIR}}/{{.BINARY_NAME}} docs --verbose
      - echo "âœ… Documentation generated"

  # ----------------------------------------------------------------------------
  # DOCKER
  # ----------------------------------------------------------------------------
  docker-build:
    desc: "ğŸ³ Build Docker image"
    silent: true
    cmds:
      - echo "ğŸ³ Building Docker image..."
      - docker build -t {{.BINARY_NAME}}:{{.VERSION}} .
      - echo "âœ… Docker image built at {{.BINARY_NAME}}:{{.VERSION}}"

  docker-run:
    desc: "ğŸ³ Run Docker container interactively"
    deps: [docker-build]
    silent: true
    cmds:
      - echo "ğŸ³ Running Docker container..."
      - docker run --rm -it {{.BINARY_NAME}}:{{.VERSION}}

  # ----------------------------------------------------------------------------
  # CLEANUP
  # ----------------------------------------------------------------------------
  clean:
    desc: "ğŸ§¹ Remove build artifacts and generated files"
    silent: true
    cmds:
      - echo "ğŸ§¹ Cleaning build artifacts..."
      - rm -rf {{.BUILD_DIR}}/
      - rm -f coverage.out *.test *.prof
      - go clean -cache
      - echo "âœ… Clean complete"

  clean-all:
    desc: "ğŸ§¹ Deep clean - remove all generated files including dependencies"
    deps: [clean]
    silent: true
    cmds:
      - echo "ğŸ§¹ Deep cleaning..."
      - go clean -modcache
      - rm -rf vendor/
      - echo "âœ… Deep clean complete"

  # ----------------------------------------------------------------------------
  # UTILITY
  # ----------------------------------------------------------------------------
  version:
    desc: "â„¹ï¸  Show version information"
    silent: true
    cmds:
      - echo "ğŸ“‹ Version Information:"
      - echo "   Version:" {{.VERSION}}
      - echo "   Commit:"  {{.COMMIT}}
      - echo "   Date:"    {{.BUILD_DATE}}

  help:
    desc: "â“ Show this help message"
    silent: true
    cmds:
      - echo "ğŸ› ï¸  dev-stack Task Runner"
      - echo ""
      - echo "ğŸ“‹ Quick Start:"
      - echo "   task build     - Build the binary"
      - echo "   task dev       - Build and run"
      - echo "   task test      - Run tests"
      - echo "   task lint      - Check code quality"
      - echo ""
      - echo "ğŸ”¨ Build Tasks:"
      - echo "   build          - Build binary for current platform"
      - echo "   build-all      - Build for all platforms"
      - echo "   install        - Install to GOPATH/bin"
      - echo ""
      - echo "ğŸš€ Development:"
      - echo "   dev            - Quick start (build + help)"
      - echo "   watch          - Auto-rebuild on changes"
      - echo "   deps           - Update dependencies"
      - echo ""
      - echo "ğŸ§ª Testing & Quality:"
      - echo "   test           - Run tests with coverage"
      - echo "   test-unit      - Run unit tests only"
      - echo "   test-integration - Run integration tests"
      - echo "   test-all       - Run all test types"
      - echo "   test-coverage  - View coverage in browser"
      - echo "   test-coverage-check - Check coverage threshold"
      - echo "   lint           - Run all linting checks"
      - echo "   fmt            - Format code"
      - echo "   security       - Security vulnerability scan"
      - echo ""
      - echo "ğŸ“š Documentation:"
      - echo "   docs           - Generate documentation"
      - echo ""
      - echo "ğŸ³ Docker:"
      - echo "   docker-build   - Build Docker image"
      - echo "   docker-run     - Run in container"
      - echo ""
      - echo "ğŸ§¹ Cleanup:"
      - echo "   clean          - Remove build artifacts"
      - echo "   clean-all      - Deep clean everything"
      - echo ""
      - echo "â„¹ï¸  Info:"
      - echo "   version        - Show version info"
      - echo "   help           - Show this help"
      - echo ""
      - echo "ğŸ’¡ Examples:"
      - echo "   task build && ./build/dev-stack --help"
      - echo "   task watch  (Auto-rebuild on file changes)"
      - echo "   task test && task lint"
      - echo ""
      - echo "For detailed task list:" "task --list"
